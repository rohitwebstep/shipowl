{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 92, "column": 0}, "map": {"version":3,"sources":["file://D%3A/Webstep/NextJS/sleeping-owl/src/utils/authUtils.ts"],"sourcesContent":["import jwt from 'jsonwebtoken';\r\n\r\nconst SECRET_KEY = process.env.JWT_SECRET || '3792e68ef011e0f236a60627ddf304e1bb64d76d5e4dbebca4579490d3c4e6d8c618456f29aa6f92f8dc3cbd4414362b47d4545ffdc0b9549e43b629c39282bb36b9cff7295fc4269d765d59e4d8a811113b911080878f7647e0329a072afdc06d2ecd658c8e79f2ad04e74dbffc45ed10c850b02afdf10b209989910fadaf7ddbef0bb7d0cff27ed8f4a10d3415420107ddba2d9ac8bcf4f7b3b942b5bbe600d9007f9e88b2451cbfaeaab239677b3ed28eaa860eb40fd5d0e36969b6943a3215d2a9f1125ca06be806f8d73d8ae642c4a29b3a728cf42305e1150e4c1f3ed6e14bd3662531cd14357c6b3f3a57095609811f5e9459307cbe70f9b7a159c8d3';\r\n\r\nexport function generateToken(userId: string) {\r\n    return jwt.sign({ userId }, SECRET_KEY, { expiresIn: '1h' });\r\n}\r\n\r\nexport function verifyToken(token: string) {\r\n    try {\r\n        const decoded = jwt.verify(token, SECRET_KEY);\r\n\r\n        const now = Date.now();\r\n        const inactivityLimit = 60 * 60 * 1000; // 1 hour of inactivity\r\n        console.log(`decoded.lastActivity - `, decoded.lastActivity);\r\n        // Check inactivity timeout\r\n        if (now - decoded.lastActivity > inactivityLimit) {\r\n            return null; // Token expired due to inactivity\r\n        }\r\n\r\n        return decoded; // Token is valid and active\r\n    } catch (error) {\r\n        return null; // Invalid or expired token\r\n    }\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAEtC,SAAS,cAAc,MAAc;IACxC,OAAO,uIAAA,CAAA,UAAG,CAAC,IAAI,CAAC;QAAE;IAAO,GAAG,YAAY;QAAE,WAAW;IAAK;AAC9D;AAEO,SAAS,YAAY,KAAa;IACrC,IAAI;QACA,MAAM,UAAU,uIAAA,CAAA,UAAG,CAAC,MAAM,CAAC,OAAO;QAElC,MAAM,MAAM,KAAK,GAAG;QACpB,MAAM,kBAAkB,KAAK,KAAK,MAAM,uBAAuB;QAC/D,QAAQ,GAAG,CAAC,CAAC,uBAAuB,CAAC,EAAE,QAAQ,YAAY;QAC3D,2BAA2B;QAC3B,IAAI,MAAM,QAAQ,YAAY,GAAG,iBAAiB;YAC9C,OAAO,MAAM,kCAAkC;QACnD;QAEA,OAAO,SAAS,4BAA4B;IAChD,EAAE,OAAO,OAAO;QACZ,OAAO,MAAM,2BAA2B;IAC5C;AACJ","debugId":null}},
    {"offset": {"line": 127, "column": 0}, "map": {"version":3,"sources":["file://D%3A/Webstep/NextJS/sleeping-owl/src/app/api/admin/auth/verify/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { verifyToken } from '@/utils/authUtils';\r\n\r\nexport async function GET(req: NextRequest) {\r\n    const token = req.headers.get('authorization')?.split(' ')[1];\r\n    if (!token) {\r\n        return NextResponse.json({ error: 'No token provided' }, { status: 401 });\r\n    }\r\n\r\n    const decoded = verifyToken(token);\r\n    console.log(`decoded - `, decoded);\r\n    if (!decoded) {\r\n        return NextResponse.json({ error: 'Invalid token' }, { status: 403 });\r\n    }\r\n\r\n    return NextResponse.json({ message: 'Token is valid', userId: decoded.userId, user: decoded });\r\n}\r\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,eAAe,IAAI,GAAgB;IACtC,MAAM,QAAQ,IAAI,OAAO,CAAC,GAAG,CAAC,kBAAkB,MAAM,IAAI,CAAC,EAAE;IAC7D,IAAI,CAAC,OAAO;QACR,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAoB,GAAG;YAAE,QAAQ;QAAI;IAC3E;IAEA,MAAM,UAAU,CAAA,GAAA,2HAAA,CAAA,cAAW,AAAD,EAAE;IAC5B,QAAQ,GAAG,CAAC,CAAC,UAAU,CAAC,EAAE;IAC1B,IAAI,CAAC,SAAS;QACV,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAgB,GAAG;YAAE,QAAQ;QAAI;IACvE;IAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;QAAE,SAAS;QAAkB,QAAQ,QAAQ,MAAM;QAAE,MAAM;IAAQ;AAChG","debugId":null}}]
}