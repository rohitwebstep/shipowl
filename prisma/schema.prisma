// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "./prisma/generated/client"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model emailConfig {
  id             BigInt   @id @default(autoincrement())

  panel          String
  module         String
  subject        String
  action         String
  html_template  String?   @db.LongText

  smtp_host      String
  smtp_secure    Boolean
  smtp_port      Int
  smtp_username  String
  smtp_password  String

  from_email     String
  from_name      String

  status         Boolean

  createdAt      DateTime @default(now())
  createdBy      Int?
  createdByRole  String?
  updatedAt      DateTime @updatedAt
  updatedBy      Int?
  updatedByRole  String?

  @@index([createdBy])
  @@index([updatedBy])
}

model admin {
  id                   Int         @id @default(autoincrement())
  profilePicture       String?     @db.LongText
  name                 String
  username             String?     @unique
  website              String?
  email                String
  referralCode         String?
  password             String
  role                 String      @default("admin")
  status               String      @default("active")
  dateOfBirth          DateTime?
  phoneNumber          String?
  currentAddress       String?
  permanentAddress     String?
  permanentPostalCode  String?
  permanentCityId      BigInt?
  permanentStateId     BigInt?
  permanentCountryId   BigInt?
  pr_token             String?
  pr_expires_at        DateTime?
  pr_last_reset        DateTime?

  createdAt            DateTime  @default(now())
  createdBy            Int?
  createdByRole        String?
  updatedAt            DateTime  @updatedAt
  updatedBy            Int?
  updatedByRole        String?
  deletedAt            DateTime?
  deletedBy            Int?
  deletedByRole        String?

  permanentCity       city?       @relation(fields: [permanentCityId], references: [id], onDelete: SetNull)
  permanentState      state?      @relation(fields: [permanentStateId], references: [id], onDelete: SetNull)
  permanentCountry    country?    @relation(fields: [permanentCountryId], references: [id], onDelete: SetNull)

  staff                adminStaff[]
  companyDetail        companyDetail?    @relation
  bankAccounts         bankAccount[]
}

model companyDetail {
  id                              Int       @id @default(autoincrement())
  adminId                         Int       @unique
  companyName                     String?
  brandName                       String?
  brandShortName                  String?
  billingAddress                  String?
  billingPincode                  String?
  billingState                    String?
  billingCity                     String?
  businessType                    String?
  clientEntryType                 String?
  gstNumber                       String?
  companyPanNumber                String?
  aadharNumber                    String?
  gstDocument                     String?     // File path or URL
  panCardHolderName               String?
  aadharCardHolderName            String?
  panCardImage                    String?     @db.LongText
  aadharCardImage                 String?     @db.LongText
  additionalDocumentUpload        String?  // Optional file or zip path
  documentId                      String?
  documentName                    String?
  documentImage                   String?     @db.LongText

  createdAt                       DateTime  @default(now())
  createdBy                       Int?
  createdByRole                   String?
  updatedAt                       DateTime  @updatedAt
  updatedBy                       Int?
  updatedByRole                   String?
  deletedAt                       DateTime?
  deletedBy                       Int?
  deletedByRole                   String?

  admin                           admin      @relation(fields: [adminId], references: [id], onDelete: Cascade)
}

model bankAccount {
  id                     Int       @id @default(autoincrement())
  adminId                Int
  accountHolderName      String
  accountNumber          String
  bankName               String
  bankBranch             String
  accountType            String
  ifscCode               String
  cancelledChequeImage   String?     @db.LongText
  paymentMethod          String?

  createdAt              DateTime  @default(now())
  createdBy              Int?
  createdByRole          String?
  updatedAt              DateTime  @updatedAt
  updatedBy              Int?
  updatedByRole          String?
  deletedAt              DateTime?
  deletedBy              Int?
  deletedByRole          String?

  admin                  admin      @relation(fields: [adminId], references: [id], onDelete: Cascade)
}

model adminStaff {
  id                   Int       @id @default(autoincrement())
  admin_id             Int       @unique
  name                 String    
  email                String    @unique
  password             String
  role                 String    @default("admin")
  status               String    @default("active")
  pr_token             String?
  pr_expires_at        DateTime?
  pr_last_reset        DateTime?

  createdAt            DateTime  @default(now())
  createdBy            Int?
  createdByRole        String?
  updatedAt            DateTime  @updatedAt
  updatedBy            Int?
  updatedByRole        String?
  deletedAt            DateTime?
  deletedBy            Int?
  deletedByRole        String?

  admin                admin     @relation(fields: [admin_id], references: [id], onDelete: Cascade)
}

model loginLog {
  id                      Int       @id @default(autoincrement())
  adminId                 Int
  adminRole               String
  action                  String
  response                String?

  ipv4                    String?
  ipv6                    String?
  internetServiceProvider String?
  clientInformation       String?
  userAgent               String?

  createdAt               DateTime  @default(now())
  createdBy               Int?
  createdByRole           String?
  updatedAt               DateTime  @updatedAt
  updatedBy               Int?
  updatedByRole           String?
  deletedAt               DateTime?
  deletedBy               Int?
  deletedByRole           String?

  @@index([adminId])
  @@index([adminRole])
  @@index([action])
  @@index([createdAt])
  @@index([deletedAt])
}

model activityLog {
  id                      Int       @id @default(autoincrement())
  adminId                 Int
  adminRole               String
  module                  String
  action                  String
  endpoint                String
  method                  String
  payload                 String?     @db.LongText
  response                String?     @db.LongText
  result                  Boolean
  data                    String?     @db.LongText

  ipv4                    String?
  ipv6                    String?
  internetServiceProvider String?
  clientInformation       String?
  userAgent               String?

  createdAt               DateTime   @default(now())
  createdBy               Int?
  createdByRole           String?
  updatedAt               DateTime   @updatedAt
  updatedBy               Int?
  updatedByRole           String?
  deletedAt               DateTime?
  deletedBy               Int?
  deletedByRole           String?

  @@index([adminId])
  @@index([adminRole])
  @@index([module])
  @@index([action])
  @@index([createdAt])
  @@index([deletedAt])
}

model country {
  id                    BigInt          @id @default(autoincrement())
  name                  String
  iso3                  String?
  iso2                  String?
  phonecode             String?
  currency              String?
  currencyName          String?
  currencySymbol        String?
  nationality           String?
  createdAt             DateTime        @default(now())
  createdBy             Int?
  createdByRole         String?
  updatedAt             DateTime        @updatedAt
  updatedBy             Int?
  updatedByRole         String?
  deletedAt             DateTime?
  deletedBy             Int?
  deletedByRole         String?

  states                state[]
  cities                city[]
  warehouses            warehouse[]
  highRtos              highRto[]
  admins                admin[]

  // Add the relation fields for `originCountry` and `shippingCountry`
  originProducts        product[]       @relation("OriginCountryRelation")
  shippingProducts      product[]       @relation("ShippingCountryRelation")

  @@index([createdBy])
  @@index([updatedBy])
  @@index([deletedAt])
}

model state {
  id              BigInt     @id @default(autoincrement())
  name            String
  countryId       BigInt
  iso2            String?
  type            String?
  createdAt       DateTime  @default(now())
  createdBy       Int?
  createdByRole   String?
  updatedAt       DateTime  @updatedAt
  updatedBy       Int?
  updatedByRole   String?
  deletedAt       DateTime?
  deletedBy       Int?
  deletedByRole   String?

  country         country    @relation(fields: [countryId], references: [id], onDelete: Cascade)
  cities          city[]
  warehouses      warehouse[]
  highRtos        highRto[]
  admins          admin[]

  @@index([countryId])
}

model city {
  id              BigInt     @id @default(autoincrement())
  name            String
  stateId         BigInt
  countryId       BigInt
  createdAt       DateTime  @default(now())
  createdBy       Int?
  createdByRole   String?
  updatedAt       DateTime  @updatedAt
  updatedBy       Int?
  updatedByRole   String?
  deletedAt       DateTime?
  deletedBy       Int?
  deletedByRole   String?

  state           state      @relation(fields: [stateId], references: [id], onDelete: Cascade)
  country         country    @relation(fields: [countryId], references: [id], onDelete: Cascade)
  warehouses      warehouse[]
  highRtos        highRto[]
  admins          admin[]

  @@index([stateId])
  @@index([countryId])
}

model warehouse {
  id              Int       @id @default(autoincrement())
  name            String
  slug            String    @unique
  gst_number      String
  contact_name    String
  contact_number  String
  address_line_1  String
  address_line_2  String?
  postal_code     String

  countryId       BigInt?
  stateId         BigInt?
  cityId          BigInt?

  country         country?    @relation(fields: [countryId], references: [id], onDelete: SetNull)
  state           state?      @relation(fields: [stateId], references: [id], onDelete: SetNull)
  city            city?       @relation(fields: [cityId], references: [id], onDelete: SetNull)

  status          Boolean   @default(false)
  
  createdAt       DateTime  @default(now())
  createdBy       Int?
  createdByRole   String?
  updatedAt       DateTime  @updatedAt
  updatedBy       Int?
  updatedByRole   String?
  deletedAt       DateTime?
  deletedBy       Int?
  deletedByRole   String?

  @@index([countryId])
  @@index([stateId])
  @@index([cityId])
  @@index([createdBy])
  @@index([updatedBy])
  @@index([deletedAt])
}

model category {
  id                   Int              @id @default(autoincrement())
  name                 String
  slug                 String           @unique
  description          String?          @db.LongText
  image                String?          @db.LongText
  status               Boolean          @default(false)
  createdAt            DateTime         @default(now())
  createdBy            Int?
  createdByRole        String?
  updatedAt            DateTime         @updatedAt
  updatedBy            Int?
  updatedByRole        String?
  deletedAt            DateTime?
  deletedBy            Int?
  deletedByRole        String?

  products             product[]
  productRequests      productRequest[]

  @@index([createdBy])
  @@index([updatedBy])
  @@index([deletedAt])
}

model brand {
  id             Int       @id @default(autoincrement())
  name           String
  slug           String    @unique
  description    String?   @db.LongText
  image          String?   @db.LongText
  status         Boolean   @default(false)
  createdAt      DateTime  @default(now())
  createdBy      Int?
  createdByRole  String?
  updatedAt      DateTime  @updatedAt
  updatedBy      Int?
  updatedByRole  String?
  deletedAt      DateTime?
  deletedBy      Int?
  deletedByRole  String?

  products      product[]
  @@index([createdBy])
  @@index([updatedBy])
  @@index([deletedAt])
}

model productRequest {
  id                        Int             @id @default(autoincrement())
  name                      String
  categoryId                Int
  expectedPrice             Int?
  expectedDailyOrders       String?
  url                       String?         @db.LongText
  image                     String?         @db.LongText

  status                    Boolean         @default(true)
  createdAt                 DateTime        @default(now())
  createdBy                 Int?
  createdByRole             String?
  updatedAt                 DateTime        @updatedAt
  updatedBy                 Int?
  updatedByRole             String?
  deletedAt                 DateTime?
  deletedBy                 Int?
  deletedByRole             String?

  category                  category        @relation(fields: [categoryId], references: [id])
}

model product {
  id                              Int              @id @default(autoincrement())
  categoryId                      Int
  name                            String
  slug                            String           @unique
  main_sku                        String           @unique
  description                     String?          @db.LongText
  tags                            Json?            // store as array of strings
  brandId                         Int
  originCountryId                 BigInt
  ean                             String?
  hsnCode                         String?
  taxRate                         Float?
  upc                             String?
  rtoAddress                      String?
  pickupAddress                   String?

  shippingCountryId               BigInt
  video_url                       String?          @db.LongText
  list_as                         String?          // e.g., featured, trending, etc.

  shipping_time                   String?
  weight                          Float?

  package_length                  Float?           // Updated from package_len
  package_width                   Float?           // Updated from pack_width
  package_height                  Float?           // Updated from package_heig
  chargeable_weight               Float?           // Updated from chargab_weig
  package_weight_image            String?          @db.LongText
  package_length_image            String?          @db.LongText
  package_width_image             String?          @db.LongText
  package_height_image            String?          @db.LongText
  product_detail_video            String?          @db.LongText
  training_guidance_video         String?          @db.LongText

  status                          Boolean          @default(true)
  createdAt                       DateTime         @default(now())
  createdBy                       Int?
  createdByRole                   String?
  updatedAt                       DateTime         @updatedAt
  updatedBy                       Int?
  updatedByRole                   String?
  deletedAt                       DateTime?
  deletedBy                       Int?
  deletedByRole                   String?

  category                        category         @relation(fields: [categoryId], references: [id])
  brand                           brand            @relation(fields: [brandId], references: [id])
  originCountry                   country          @relation("OriginCountryRelation", fields: [originCountryId], references: [id])
  shippingCountry                 country          @relation("ShippingCountryRelation", fields: [shippingCountryId], references: [id])

  variants                        productVariant[]

  @@index([categoryId])
  @@index([brandId])
  @@index([originCountryId])
  @@index([shippingCountryId])
  @@index([createdBy])
  @@index([updatedBy])
  @@index([deletedAt])
}

model productVariant {
  id                        Int              @id @default(autoincrement())
  productId                 Int
  image                     String          @db.LongText
  color                     String
  sku                       String           @unique
  qty                       Int
  currency                  String
  article_id                String?
  product_link              String?
  suggested_price           Float?
  shipowl_price             Float?
  rto_suggested_price       Float?
  rto_price                 Float?

  createdAt                 DateTime         @default(now())
  createdBy                 Int?
  createdByRole             String?
  updatedAt                 DateTime         @updatedAt
  updatedBy                 Int?
  updatedByRole             String?
  deletedAt                 DateTime?
  deletedBy                 Int?
  deletedByRole             String?

  product                   product          @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@index([productId])
}

model courierCompany {
  id                   Int         @id @default(autoincrement())
  name                 String
  slug                 String      @unique
  code                 String?     @unique
  website              String?     @db.LongText
  email                String
  phoneNumber          String?
  status               Boolean     @default(true)

  createdAt            DateTime    @default(now())
  createdBy            Int?
  createdByRole        String?
  updatedAt            DateTime    @updatedAt
  updatedBy            Int?
  updatedByRole        String?
  deletedAt            DateTime?
  deletedBy            Int?
  deletedByRole        String?
}

model highRto {
  id              Int       @id @default(autoincrement())
  pincode         String

  countryId       BigInt?
  stateId         BigInt?
  cityId          BigInt?

  country         country?    @relation(fields: [countryId], references: [id], onDelete: SetNull)
  state           state?      @relation(fields: [stateId], references: [id], onDelete: SetNull)
  city            city?       @relation(fields: [cityId], references: [id], onDelete: SetNull)

  status          Boolean   @default(false)
  
  createdAt       DateTime  @default(now())
  createdBy       Int?
  createdByRole   String?
  updatedAt       DateTime  @updatedAt
  updatedBy       Int?
  updatedByRole   String?
  deletedAt       DateTime?
  deletedBy       Int?
  deletedByRole   String?

  @@index([countryId])
  @@index([stateId])
  @@index([cityId])
  @@index([createdBy])
  @@index([updatedBy])
  @@index([deletedAt])
}

model Payment {
  id              Int       @id @default(autoincrement())
  transactionId   String    @unique
  cycle           String?
  amount          Float?
  status          String?
  
  createdAt       DateTime  @default(now())
  createdBy       Int?
  createdByRole   String?
  updatedAt       DateTime  @updatedAt
  updatedBy       Int?
  updatedByRole   String?
  deletedAt       DateTime?
  deletedBy       Int?
  deletedByRole   String?

  @@index([createdBy])
  @@index([updatedBy])
  @@index([deletedAt])
}
